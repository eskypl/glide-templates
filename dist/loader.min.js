!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports&&(module.exports=b())}(this,function(){var a,b,c,d,e,f,g;return a=function(){function a(a){this.tagResolvers={},this.deps=[];for(var b in this.tagDefinisions)this.tagResolvers[b]=this.compileTag(b,a[b])}return a.prototype={compileTag:function(a,b){return[new RegExp("{"+this.tagDefinisions[a]+"}","g"),this.giveContext(b)]},getResolvedDependencies:function(){return this.deps||[]},tagDefinisions:{conditional:"if\\s+(.+?)",conditionalElse:"else",conditionalElseIf:"else\\s+(.+?)",conditionalEnd:"\\/if",loop:"foreach\\s+(.+?)\\s+as\\s+(\\$\\w+)",loopEnd:"\\/foreach",loopExpression:"@([a-z]+)",expression:"(\\$.+?)",include:"include\\s+template=(.+?)\\s*(\\s*[a-z]+[a-z0-9]*=.+?)?",translate:"i18n\\s+key=(.+?)\\s*(\\s*[a-zA-Z0-9]+=.+?)?",comment:"\\*\\s+.+?\\s+\\*",debug:"debug\\s+var=(\\$.+?)",assign:"assign\\s+var=(\\$\\w+)\\s+value=(.+?)"}},a}(),b=function(){function a(a){this.tagResolvers=[],this.deps=[];for(var b in this.tagDefinisions)this.tagResolvers[b]=this.compileTag(b,a[b])}return a.prototype={compileTag:function(a,b){var c,d=this.tagDefinisions[a],e=d,f=b;return d instanceof Array&&(e=d[0],f=d[1]),c="expression"===a||"loopExpression"===a?"{{\\s*"+e+"\\s*}}":"comment"===a?"{#\\s*"+e+"\\s*#}":"{%\\s*"+e+"\\s*%}",[new RegExp(c,"g"),this.giveContext(f)]},getResolvedDependencies:function(){return this.deps||[]},tagDefinisions:{conditional:"if\\s+(.+?)",conditionalElse:"else",conditionalElseIf:"else\\s+(.+?)",conditionalEnd:"endif",loop:["for\\s+(\\$\\w+)\\s+in\\s+(.+?)",'";_this.e($2,function($1,i){_+="'],loopEnd:"endfor",loopExpression:"@([a-z]+)",expression:"(\\$.+?)",include:"include\\s+'(.+?)'(?:\\s+with\\s+(.+?))?",translate:"i18n\\s+'(.+?)'(?:\\s+with\\s+(.+?))?",comment:"\\s+.+?\\s+",debug:"debug\\s+(\\$.+?)",assign:"set\\s+(\\$\\w+)\\=(.+?)"}},a}(),c=function(a,b){function c(a){if(!0===g.test(a))return d(a);for(var b,c=[],e=a.split(f),h=0,i=e.length;i>h;h++)b=e[h].split("="),0===b[1].indexOf("@")?b[1]="i."+b[1].substr(1):0!==b[1].indexOf("$")&&(b[1]='"'+b[1]+'"'),c.push('"'+b[0]+'":'+b[1]);return"{"+c.join(",")+"}"}function d(a){return a?a.replace("@","i."):void 0}var e={smarty:a,twig:b},f=/\s+/,g=/^{(\s*[a-z][a-z0-9]*:\s*@?[\w\$\.\[\]\(\)]+\s*)(,\s*[a-z][a-z0-9]*:\s*@?[\w\$\.\[\]\(\)]+\s*)*}$/i,h={conditional:function(a,b){return'";if('+d(b)+'){_+="'},conditionalElse:'";}else{_+="',conditionalElseIf:function(a,b){return'";}else if('+d(b)+'){_+="'},conditionalEnd:'";}_+="',loop:'";_this.e($1,function($2,i){_+="',loopEnd:'";});_+="',loopExpression:'"+i.$1+"',expression:'"+$1+"',include:function(a,b,d){var e="";return d&&(e=c(d)),this.deps.push("view!"+b+".tpl"),'"+_this.f('+(this.deps.length-1)+","+(e?e:"$tpl")+')+"'},translate:function(a,b,d){var e="";return d&&(e=","+c(d)),'"+_this.t("'+b+'"'+e+')+"'},comment:"",debug:function(a,b){return'";console.log('+d(b)+');_+="'},assign:function(a,b,c){return'";var '+b+"="+d(c)+';_+="'}},i={giveContext:function(a){if("function"!=typeof a)return a;var b=this,c=function(){},d=function(){return a.apply(a instanceof c&&b?a:b,Array.prototype.slice.call(arguments))};return c.prototype=a.prototype,d.prototype=new c,d}};for(var j in e)for(var k in i)e[j].prototype[k]=i[k];return function(a){if(!a)throw"Missing template syntax name";var b=a.toLowerCase();if(!e[b])throw"Unsupported templateing syntax style";return new e[b](h)}}(a,b),d=function(a){function b(a){return"string"==typeof a&&a.length?a.replace(e,"").replace(f,"\\$&").replace(g,"&"):a}function c(a){return a.replace(/_\+="";/g,"").replace(/=""\+/g,"=").replace(/\+"";/g,";")}function d(d,e){var f,g=b(d),j=h[i[e]],k=new a(j),l=k.tagResolvers;for(var m in l)g=g.replace(l[m][0],l[m][1]);g=c('var _this=this,_="";_+="'+g+'";return _;');try{return f=new Function("$tpl",g),f.deps=k.getResolvedDependencies(),f}catch(n){throw n instanceof SyntaxError&&(n.message+=' in "'+g+'"'),"Template compilation error: "+n.stack||n.message}}var e=/^\s*|\r|\n|\t|\s*$/g,f=/"/g,g=/&amp;/g,h=["smarty","twig"],i={tpl:0,smarty:0,twig:1};return d}(c),e=function(){function a(b,c){var d=b.shift();return b.length&&"string"!=typeof c[d]?a(b,c[d]):c[d]}function b(b,c){var e,f;return g[b]?g[b]:(e=b.split(d),f=a(e,c),f&&(g[b]=f),f)}var c="object"==typeof document?document:!1,d=".",e=c&&-1!==c.cookie.indexOf("translationDebugMode=debug;"),f=/{\$?(\w+)}|{{\$?(\w+)}}/g,g={},h="object"==typeof i18n?i18n:{};return{translate:function(a,c){var d=b(a,h);return!d||e?"__{"+a+"}__":(c&&d.search(f)&&(d=d.replace(f,function(a,b,d){return b?c[b]||a:c[d]||a})),d)}}}(),f=function(a){function b(a,b){var c,d;return this.deps=a.deps||[],this.includes=a.includes||[],c=this,d=function(d,e){try{e(null,a.call(c,d))}catch(f){f.message+=' in template "'+b+'": '+a.toString(),e(f)}},d.moduleName=b,d.fn=a,d}return b.prototype={i:function(a,b,c){var d=b+1,e=d%2===0;return{key:a,index:b,total:c,number:d,last:d===c,first:0===b,even:e,odd:!e}},e:function(a,b){var c,d,e=0;if(a)if(a instanceof Array)for(e=0,c=a.length;c>e;e++)b(a[e],this.i(e,e,c));else{c=this.c(a);for(d in a)a.hasOwnProperty(d)&&b(a[d],this.i(d,e++,c))}},c:function(a){var b=0;if(!a)return 0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},f:function(a,b){var c=this.includes[a].fn;if("function"!=typeof c||c.includes&&c.includes.length)throw new Error("Cannot include template ("+this.deps[a]+") which has dependencies");return c.call(this,b)},t:a.translate},b}(e),g=function(a,b,c){function d(a){var b=a.match(/\.(\w+)$/i);return b&&b.length?b[1].toLowerCase():b}function e(a,e,f,g){var h=b(e,d(a));h.includes=[],h.deps&&h.deps.length?f(h.deps,function(){for(var b=0,d=h.deps.length;d>b;b++)h.includes.push(arguments[b]);g(new c(h,a))}):g(new c(h,a))}return{version:"1.0.0",load:function(a,b,c){var d=new XMLHttpRequest;d.open("GET",b.toUrl(a),!0),d.onreadystatechange=function(){var f=d.status||0;if(4===d.readyState){if(f>399&&600>f)return c.error(new Error(a+" HTTP status: "+f));try{e(a,d.responseText,b,c)}catch(g){c.error(g)}}},d.send(null)}}}({},d,f)});